#!/usr/bin/env bash
cd "$(dirname "$(stat -f "$0")")" || (echo "cd into dotfile directory failed"; exit)
git pull
list=$(find `/bin/ls | sed -e 's/^update$//'` -type f)
dir="$(pwd)"
cd || (echo "failed to cd into home directory"; exit)
for i in $list; do
    if [[ -f ".$i.OLD" ]]; then
        rm ".$i.OLD"
    fi
    if [[ -f ".$i" ]]; then
        mv ".$i" ".$i.OLD"
    fi
    if [[ $i =~ / ]]; then
        mkdir -p ".${i%/*}"
    fi
    ln "$dir/$i" ".$i"
done
#git clone git@github.com:xayon40-12/.vim
#cd ~/.vim && git pull && ./init
#git clone git@github.com:xayon40-12/.doom.d
#cd ~/.doom.d && git pull && ~/.doom.d/install
cd ~/.config || (echo "cd into ~/.config failed"; exit)
if [[ ! -d nvim/ ]]; then
  git clone git@github.com:xayon40-12/nvim
  cd ~/.config/nvim || (echo "cd into ~/.config/nvim failed"; exit)
  ./install
else
  cd ~/.config/nvim || (echo "cd into ~/.config/nvim failed"; exit)
  git pull
fi
